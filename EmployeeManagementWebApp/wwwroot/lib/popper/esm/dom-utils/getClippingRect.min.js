import{viewport}from"../enums.js";import getViewportRect from"./getViewportRect.js";import getDocumentRect from"./getDocumentRect.js";import listScrollParents from"./listScrollParents.js";import getOffsetParent from"./getOffsetParent.js";import getDocumentElement from"./getDocumentElement.js";import getComputedStyle from"./getComputedStyle.js";import{isElement,isHTMLElement}from"./instanceOf.js";import getBoundingClientRect from"./getBoundingClientRect.js";import contains from"./contains.js";import getNodeName from"./getNodeName.js";import rectToClientRect from"../utils/rectToClientRect.js";function getInnerBoundingClientRect(t){var e=getBoundingClientRect(t);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}function getClientRectFromMixedType(t,e){return e===viewport?rectToClientRect(getViewportRect(t)):isHTMLElement(e)?getInnerBoundingClientRect(e):rectToClientRect(getDocumentRect(getDocumentElement(t)))}function getClippingParents(t){var e=listScrollParents(t),n=["absolute","fixed"].indexOf(getComputedStyle(t).position)>=0&&isHTMLElement(t)?getOffsetParent(t):t;return isElement(n)?e.filter(function(t){return isElement(t)&&contains(t,n)&&"body"!==getNodeName(t)}):[]}export default function getClippingRect(t,e,n){var o="clippingParents"===e?getClippingParents(t):[].concat(e),i=[].concat(o,[n]),r=i[0],m=i.reduce(function(e,n){var o=getClientRectFromMixedType(t,n);return e.top=Math.max(o.top,e.top),e.right=Math.min(o.right,e.right),e.bottom=Math.min(o.bottom,e.bottom),e.left=Math.max(o.left,e.left),e},getClientRectFromMixedType(t,r));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m};